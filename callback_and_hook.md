# 一分钟弄清楚 _回调函数_ 和 _钩子函数_

## callback (回调函数)

- 小栗子
  - 你去超市买辣条,结果没货了,你给店长留了电话号码,第二天辣条到货了,店长打电话给你,你来拿辣条.
- 解释
  - 这个栗子里,你的电话号码叫**回调函数**,你留电话给店长叫做**注册回调函数**,辣条到货了叫触发**回调绑定事件**，店长打电话给你叫**调用回调函数**，你去拿辣条叫**响应回调事件**。
- 定义
  - 回调函数就是一个通过函数指针调用的函数。如果你把函数的指针（地址）作为参数传递给另一个函数，当这个指针被用来调用其所指向的函数时，我们就说这是回调函数。回调函数不是由该函数的实现方直接调用，而是在特定的事件或条件发生时由另外的一方调用的，用于对该事件或条件进行响应。
- javascript中的回调函数
  - Array.sort(callback)
  - callback: 定义排序规则的用户自定义函数（指针或叫变量）
  - 这里的callback由用户编写，却不由用户调用，而由sort方法比较两个值大小时调用。sort方法根据callback的返回值决定排序规则。
- 特点
  - 不由编写者调用，在系统内部关联回调函数的事件触发时由系统调用
  - 把不同的具体操作统一到一个接口，比如sort方法的回调函数实现了各种千奇百怪的用户自定义排序规则

## hook (钩子函数)

- 小栗子
  - 螺蛳粉店的螺蛳粉可以加很多料，卤蛋，油豆腐，鸡脚等等，也可以不加，有的人加料，有的人不加，每个人想加的料也不同，螺蛳粉店怎么办呢，在做好螺蛳粉后，把碗给你，让你加料，你加了鸡蛋，你朋友加了油豆腐，另一个人加了鸡脚，然后又把碗给老板去加汤，最后再端给你吃。
- 解释
  - 那么这和钩子函数有什么关系呢？假定正常流程为： **加粉->加汤->食用**。现在由于加料的原因，老板定义了一个钩子叫加料函数，提供给顾客，你在加料函数里写了**加鸡蛋**，你朋友写了**加油豆腐**，另外一个人写了**加鸡脚**，还有人写了**加空**，然后把这些函数挂到老板定义的钩子上，现在流程变为了**加粉->执行加料函数->加汤->食用**。
- 和回调函数的异同
  - 异
    - 钩子是把一个流程劈开，横插一脚，做一些处理，再继续流程,接下来的流程中并不关心这个处理造成的结果，或者说这个处理的结果不会影响到后续的流程进行。回调函数则是在执行某个任务时需要外界的帮助(比如sort的排序规则定义),并把这个帮助外包给别人来做，自己很关心这个外包函数的返回结果(sort关心callback返回-1， 0 或 1)，因为后面的处理要根据回调函数的结果来进行选择。
    - 回调函数有可能不执行(当回调函数绑定的事件不触发时)，而钩子函数一定会执行，就算钩子函数什么也不做也会执行。
  - 同
    - 都提供了一种求同存异的灵活。
    - 都实现了系统内部与外部回调或钩子的解耦。
- 特点
  - 在一个有**既定的生命周期**的流程中的某些个特定时刻劈开，挂上钩子，待别人挂函数。
  - 类似于面向切面编程思想 AOP

### 好了,妈妈再也不用担心我不懂回调和钩子了！